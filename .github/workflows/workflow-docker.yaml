name: Run CI/CD Workflow

on:
  push:
  workflow_dispatch:

jobs:
  publish_docker:
    name: "Run automated workflow"
    uses: rcsb/devops-cicd-github-actions/.github/workflows/workflow-docker.yaml@master
    with:
      dockerfile_location: "Dockerfile"
      repo_url: "harbor.devops.k8s.rcsb.org"
      repo_project: "rcsb"
      docker_image_name: "rcsb-chemsearch"
      docker_build_context: "."
  #skaffold_deploy_staging:
  #  name: "Skaffold deploy into staging namespace"
  #  if: (github.ref == "refs/heads/k8s-staging") && (github.event_name != 'pull_request')
  #  needs:
  #    - publish_docker
  #  uses: ./.github/workflows/deploy_skaffold.yaml
  #  with:
  #    namespace: staging
  #    profile: staging
